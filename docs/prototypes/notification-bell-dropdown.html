<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notification Bell Dropdown - Prototype</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/shared-styles.css">
  <style>
    /* Design tokens from design system */
    :root {
      --color-bg-primary: #1d2022;
      --color-bg-secondary: #262a2d;
      --color-bg-tertiary: #2f3336;
      --color-bg-hover: #363a3e;
      --color-text-primary: #d7d3d0;
      --color-text-secondary: #a8a5a3;
      --color-text-tertiary: #7a7876;
      --color-accent-orange: #cb4e1b;
      --color-accent-orange-hover: #e5591f;
      --color-accent-blue: #098ecf;
      --color-accent-blue-hover: #0ba3ea;
      --color-border-primary: #3f4447;
      --color-border-secondary: #2f3336;
      --color-border-focus: #098ecf;
      --color-success: #10b981;
      --color-warning: #f59e0b;
      --color-error: #ef4444;
      --color-info: #06b6d4;
    }

    body {
      background-color: var(--color-bg-primary);
      color: var(--color-text-primary);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    }

    /* Notification Badge */
    .notification-badge {
      position: absolute;
      top: 0;
      right: 0;
      min-width: 1.125rem;
      height: 1.125rem;
      padding: 0 0.25rem;
      background-color: var(--color-accent-orange);
      color: #ffffff;
      font-size: 0.625rem;
      font-weight: 700;
      line-height: 1.125rem;
      text-align: center;
      border-radius: 0.5625rem;
      border: 2px solid var(--color-bg-secondary);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .notification-badge.hidden {
      display: none;
    }

    .notification-badge.pulse-once {
      animation: badge-pulse 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes badge-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    /* Notification Dropdown */
    .notification-dropdown {
      position: absolute;
      right: 0;
      top: calc(100% + 0.5rem);
      width: 360px;
      background-color: var(--color-bg-tertiary);
      border: 1px solid var(--color-border-primary);
      border-radius: 0.5rem;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      opacity: 0;
      visibility: hidden;
      transform: translateY(-8px);
      transition: all 0.15s ease-out;
      z-index: 350;
      display: flex;
      flex-direction: column;
      max-height: 480px;
    }

    .notification-dropdown.active {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    /* Header */
    .notification-dropdown-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
      border-bottom: 1px solid var(--color-border-primary);
      flex-shrink: 0;
    }

    .notification-mark-all-read {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0.375rem 0.625rem;
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--color-text-secondary);
      background-color: transparent;
      border: none;
      border-radius: 0.375rem;
      cursor: pointer;
      transition: all 0.15s ease-out;
    }

    .notification-mark-all-read:hover {
      color: var(--color-accent-blue);
      background-color: var(--color-bg-hover);
    }

    /* Notification List */
    .notification-list {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      scrollbar-width: thin;
      scrollbar-color: var(--color-border-primary) transparent;
    }

    .notification-list::-webkit-scrollbar {
      width: 6px;
    }

    .notification-list::-webkit-scrollbar-track {
      background: transparent;
    }

    .notification-list::-webkit-scrollbar-thumb {
      background-color: var(--color-border-primary);
      border-radius: 3px;
    }

    .notification-list::-webkit-scrollbar-thumb:hover {
      background-color: var(--color-accent-blue);
    }

    /* Footer */
    .notification-dropdown-footer {
      padding: 0.75rem 1rem;
      border-top: 1px solid var(--color-border-primary);
      background-color: var(--color-bg-secondary);
      flex-shrink: 0;
      border-radius: 0 0 0.5rem 0.5rem;
    }

    .notification-view-all {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      width: 100%;
      justify-content: center;
      padding: 0.5rem;
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--color-accent-blue);
      text-decoration: none;
      border-radius: 0.375rem;
      transition: all 0.15s ease-out;
    }

    .notification-view-all:hover {
      background-color: var(--color-bg-hover);
      color: var(--color-accent-blue-hover);
    }

    /* Notification Item */
    .notification-item {
      position: relative;
      display: grid;
      grid-template-columns: 2rem 1fr auto;
      gap: 0.75rem;
      padding: 0.875rem 1rem;
      border-bottom: 1px solid var(--color-border-secondary);
      transition: background-color 0.15s ease-out;
      cursor: pointer;
    }

    .notification-item:last-child {
      border-bottom: none;
    }

    .notification-item:hover {
      background-color: var(--color-bg-hover);
    }

    .notification-item:focus {
      outline: 2px solid var(--color-border-focus);
      outline-offset: -2px;
      background-color: var(--color-bg-hover);
    }

    .notification-item[data-read="false"] {
      background-color: rgba(9, 142, 207, 0.08);
    }

    .notification-item[data-read="false"]:hover {
      background-color: rgba(9, 142, 207, 0.12);
    }

    .notification-item[data-read="false"] .notification-title {
      font-weight: 600;
      color: var(--color-text-primary);
    }

    .notification-item[data-read="false"]::before {
      content: '';
      position: absolute;
      left: 0.375rem;
      top: 50%;
      transform: translateY(-50%);
      width: 6px;
      height: 6px;
      background-color: var(--color-accent-blue);
      border-radius: 50%;
    }

    /* Icon Container */
    .notification-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 2rem;
      height: 2rem;
      border-radius: 0.5rem;
      flex-shrink: 0;
    }

    .notification-icon-critical {
      background-color: rgba(239, 68, 68, 0.15);
      color: var(--color-error);
    }

    .notification-icon-warning {
      background-color: rgba(245, 158, 11, 0.15);
      color: var(--color-warning);
    }

    .notification-icon-info {
      background-color: rgba(6, 182, 212, 0.15);
      color: var(--color-info);
    }

    .notification-icon-success {
      background-color: rgba(16, 185, 129, 0.15);
      color: var(--color-success);
    }

    .notification-icon-guild {
      background-color: rgba(203, 78, 27, 0.15);
      color: var(--color-accent-orange);
    }

    .notification-icon-command {
      background-color: rgba(9, 142, 207, 0.15);
      color: var(--color-accent-blue);
    }

    /* Content */
    .notification-content {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      min-width: 0;
    }

    .notification-title {
      font-size: 0.8125rem;
      font-weight: 500;
      color: var(--color-text-primary);
      line-height: 1.3;
    }

    .notification-message {
      font-size: 0.75rem;
      color: var(--color-text-secondary);
      line-height: 1.4;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .notification-meta {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 0.125rem;
    }

    .notification-timestamp {
      font-size: 0.6875rem;
      color: var(--color-text-tertiary);
    }

    .notification-type-badge {
      font-size: 0.625rem;
      font-weight: 600;
      color: var(--color-text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.025em;
      padding: 0.125rem 0.375rem;
      background-color: var(--color-bg-primary);
      border-radius: 0.25rem;
    }

    /* Actions */
    .notification-actions {
      display: flex;
      align-items: flex-start;
      gap: 0.25rem;
      opacity: 0;
      transition: opacity 0.15s ease-out;
    }

    .notification-item:hover .notification-actions,
    .notification-item:focus .notification-actions {
      opacity: 1;
    }

    .notification-action-btn {
      padding: 0.375rem;
      background-color: transparent;
      border: none;
      border-radius: 0.25rem;
      color: var(--color-text-tertiary);
      cursor: pointer;
      transition: all 0.15s ease-out;
    }

    .notification-action-btn:hover {
      background-color: var(--color-bg-secondary);
      color: var(--color-text-primary);
    }

    .notification-read-icon {
      display: none;
    }

    .notification-item[data-read="false"] .notification-read-icon {
      display: none;
    }

    .notification-item[data-read="false"] .notification-unread-icon {
      display: block;
    }

    .notification-item[data-read="true"] .notification-read-icon {
      display: block;
    }

    .notification-item[data-read="true"] .notification-unread-icon {
      display: none;
    }

    .notification-overlay-link {
      position: absolute;
      inset: 0;
      z-index: 1;
    }

    .notification-actions {
      position: relative;
      z-index: 2;
    }

    /* Empty State */
    .notification-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      padding: 3rem 1.5rem;
      text-align: center;
    }

    .notification-empty-title {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--color-text-secondary);
      margin: 0;
    }

    .notification-empty-message {
      font-size: 0.8125rem;
      color: var(--color-text-tertiary);
      margin: 0;
    }

    /* Demo controls */
    .demo-controls {
      margin: 2rem auto;
      max-width: 800px;
      padding: 1.5rem;
      background-color: var(--color-bg-secondary);
      border: 1px solid var(--color-border-primary);
      border-radius: 0.5rem;
    }

    .demo-btn {
      padding: 0.5rem 1rem;
      background-color: var(--color-accent-blue);
      color: white;
      border: none;
      border-radius: 0.375rem;
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 600;
      transition: background-color 0.15s ease-out;
    }

    .demo-btn:hover {
      background-color: var(--color-accent-blue-hover);
    }

    .demo-btn-secondary {
      background-color: transparent;
      color: var(--color-text-primary);
      border: 1px solid var(--color-border-primary);
    }

    .demo-btn-secondary:hover {
      background-color: var(--color-bg-hover);
    }
  </style>
</head>
<body class="p-8">
  <div class="max-w-7xl mx-auto">
    <h1 class="text-3xl font-bold mb-2">Notification Bell Dropdown</h1>
    <p class="text-text-secondary mb-8">Interactive prototype demonstrating notification UI/UX patterns</p>

    <!-- Demo Navbar -->
    <div class="bg-bg-secondary border border-border-primary rounded-lg p-4 mb-8">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div class="w-9 h-9 rounded-lg bg-accent-orange flex items-center justify-center">
            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
              <path d="M20.317 4.492c-1.53-.69-3.17-1.2-4.885-1.49a.075.075 0 0 0-.079.036c-.21.369-.444.85-.608 1.23a18.566 18.566 0 0 0-5.487 0 12.36 12.36 0 0 0-.617-1.23A.077.077 0 0 0 8.562 3c-1.714.29-3.354.8-4.885 1.491a.07.07 0 0 0-.032.027C.533 9.093-.32 13.555.099 17.961a.08.08 0 0 0 .031.055 20.03 20.03 0 0 0 5.993 2.98.078.078 0 0 0 .084-.026 13.83 13.83 0 0 0 1.226-1.963.074.074 0 0 0-.041-.104 13.201 13.201 0 0 1-1.872-.878.075.075 0 0 1-.008-.125c.126-.093.252-.19.372-.287a.075.075 0 0 1 .078-.01c3.927 1.764 8.18 1.764 12.061 0a.075.075 0 0 1 .079.009c.12.098.245.195.372.288a.075.075 0 0 1-.006.125c-.598.344-1.22.635-1.873.877a.075.075 0 0 0-.041.105c.36.687.772 1.341 1.225 1.962a.077.077 0 0 0 .084.028 19.963 19.963 0 0 0 6.002-2.981.076.076 0 0 0 .032-.054c.5-5.094-.838-9.52-3.549-13.442a.06.06 0 0 0-.031-.028zM8.02 15.278c-1.182 0-2.157-1.069-2.157-2.38 0-1.312.956-2.38 2.157-2.38 1.21 0 2.176 1.077 2.157 2.38 0 1.312-.956 2.38-2.157 2.38zm7.975 0c-1.183 0-2.157-1.069-2.157-2.38 0-1.312.955-2.38 2.157-2.38 1.21 0 2.176 1.077 2.157 2.38 0 1.312-.946 2.38-2.157 2.38z"/>
            </svg>
          </div>
          <span class="text-lg font-bold">Bot Admin</span>
        </div>

        <div class="flex items-center gap-2">
          <!-- Bot Status Indicator -->
          <div class="hidden lg:flex items-center gap-1.5 px-2 py-1 rounded-full text-xs font-medium bg-success/10 text-success">
            <span class="w-2 h-2 rounded-full bg-success"></span>
            <span>Online</span>
          </div>

          <!-- Notification Bell Button -->
          <div class="relative">
            <button
              id="notificationBellButton"
              onclick="toggleNotificationDropdown()"
              class="relative p-2 rounded-lg text-text-secondary hover:text-text-primary hover:bg-bg-hover transition-colors"
              aria-label="Notifications"
              aria-expanded="false"
              aria-haspopup="menu"
              aria-controls="notificationDropdown"
            >
              <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
              </svg>
              <span id="notificationBadge" class="notification-badge" aria-label="5 unread notifications">5</span>
            </button>

            <!-- Notification Dropdown -->
            <div id="notificationDropdown" class="notification-dropdown" role="menu" aria-label="Notifications menu">
              <!-- Header -->
              <div class="notification-dropdown-header">
                <h3 class="text-sm font-semibold text-text-primary">Notifications</h3>
                <button onclick="markAllAsRead()" class="notification-mark-all-read" aria-label="Mark all as read">
                  <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  <span>Mark all read</span>
                </button>
              </div>

              <!-- Notification List -->
              <div class="notification-list" id="notificationList" role="list">
                <!-- Sample notifications rendered here -->
              </div>

              <!-- Footer -->
              <div class="notification-dropdown-footer">
                <a href="#" class="notification-view-all">
                  View all notifications
                  <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                  </svg>
                </a>
              </div>
            </div>
          </div>

          <!-- User Menu (placeholder) -->
          <div class="flex items-center gap-2 p-1.5 rounded-lg hover:bg-bg-hover transition-colors cursor-pointer">
            <div class="w-8 h-8 rounded-full bg-accent-blue flex items-center justify-center text-white font-semibold text-sm">
              AD
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Demo Controls -->
    <div class="demo-controls">
      <h2 class="text-lg font-semibold mb-4">Demo Controls</h2>
      <div class="flex flex-wrap gap-3">
        <button onclick="addSampleNotification('critical')" class="demo-btn">Add Critical Alert</button>
        <button onclick="addSampleNotification('warning')" class="demo-btn">Add Warning</button>
        <button onclick="addSampleNotification('guild')" class="demo-btn">Add Guild Event</button>
        <button onclick="addSampleNotification('command')" class="demo-btn">Add Command Error</button>
        <button onclick="showEmptyState()" class="demo-btn demo-btn-secondary">Show Empty State</button>
        <button onclick="resetNotifications()" class="demo-btn demo-btn-secondary">Reset to Default</button>
      </div>
    </div>

    <!-- States Documentation -->
    <div class="mt-8 p-6 bg-bg-secondary border border-border-primary rounded-lg">
      <h2 class="text-xl font-semibold mb-4">Notification States & Types</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h3 class="text-sm font-semibold text-text-secondary uppercase tracking-wider mb-3">Notification Types</h3>
          <ul class="space-y-2 text-sm">
            <li class="flex items-center gap-2">
              <span class="w-4 h-4 rounded bg-error/15 flex items-center justify-center text-error">⚠</span>
              <span>Performance Alert (Critical/Warning/Info)</span>
            </li>
            <li class="flex items-center gap-2">
              <span class="w-4 h-4 rounded bg-success/15 flex items-center justify-center text-success">✓</span>
              <span>Bot Status (Online/Offline)</span>
            </li>
            <li class="flex items-center gap-2">
              <span class="w-4 h-4 rounded bg-accent-orange/15 flex items-center justify-center text-accent-orange">⊕</span>
              <span>Guild Event (Join/Leave)</span>
            </li>
            <li class="flex items-center gap-2">
              <span class="w-4 h-4 rounded bg-accent-blue/15 flex items-center justify-center text-accent-blue">!</span>
              <span>Command Error</span>
            </li>
          </ul>
        </div>

        <div>
          <h3 class="text-sm font-semibold text-text-secondary uppercase tracking-wider mb-3">Interactive States</h3>
          <ul class="space-y-2 text-sm">
            <li><strong>Unread:</strong> Blue accent background, blue dot indicator, bold title</li>
            <li><strong>Read:</strong> Normal background, standard text weight</li>
            <li><strong>Hover:</strong> Elevated background, actions visible</li>
            <li><strong>Focus:</strong> Blue outline ring (keyboard navigation)</li>
          </ul>
        </div>
      </div>

      <div class="mt-6 pt-6 border-t border-border-primary">
        <h3 class="text-sm font-semibold text-text-secondary uppercase tracking-wider mb-3">Keyboard Navigation</h3>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
          <div>
            <kbd class="px-2 py-1 bg-bg-tertiary border border-border-primary rounded text-xs">Tab</kbd>
            <p class="text-text-tertiary mt-1">Next element</p>
          </div>
          <div>
            <kbd class="px-2 py-1 bg-bg-tertiary border border-border-primary rounded text-xs">Escape</kbd>
            <p class="text-text-tertiary mt-1">Close dropdown</p>
          </div>
          <div>
            <kbd class="px-2 py-1 bg-bg-tertiary border border-border-primary rounded text-xs">Enter</kbd>
            <p class="text-text-tertiary mt-1">Activate item</p>
          </div>
          <div>
            <kbd class="px-2 py-1 bg-bg-tertiary border border-border-primary rounded text-xs">↑↓</kbd>
            <p class="text-text-tertiary mt-1">Navigate items</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Sample notification data
    const sampleNotifications = {
      critical: {
        type: 'critical',
        icon: 'warning',
        title: 'High API Latency Detected',
        message: 'Average response time: 850ms (threshold: 500ms)',
        typeName: 'Performance Alert',
        timestamp: new Date(Date.now() - 2 * 60 * 1000),
        isRead: false,
        link: '#'
      },
      warning: {
        type: 'warning',
        icon: 'warning',
        title: 'Memory Usage Above Threshold',
        message: 'Current usage: 82% (warning threshold: 80%)',
        typeName: 'Performance Alert',
        timestamp: new Date(Date.now() - 15 * 60 * 1000),
        isRead: false,
        link: '#'
      },
      guild: {
        type: 'guild',
        icon: 'users',
        title: 'Bot Joined New Server',
        message: 'GamersHub (4,567 members)',
        typeName: 'Guild Event',
        timestamp: new Date(Date.now() - 30 * 60 * 1000),
        isRead: true,
        link: '#'
      },
      command: {
        type: 'command',
        icon: 'code',
        title: 'Command Execution Failed',
        message: '/ban failed in TestGuild: Missing permissions',
        typeName: 'Command Error',
        timestamp: new Date(Date.now() - 45 * 60 * 1000),
        isRead: true,
        link: '#'
      }
    };

    // Initialize with default notifications
    let notifications = [
      { ...sampleNotifications.critical, id: '1' },
      { ...sampleNotifications.warning, id: '2' },
      { ...sampleNotifications.guild, id: '3' },
      { ...sampleNotifications.command, id: '4' },
      { ...sampleNotifications.guild, id: '5', title: 'Bot Removed from Server', message: 'TestGuild (89 members)', isRead: false }
    ];

    function renderNotifications() {
      const list = document.getElementById('notificationList');

      if (notifications.length === 0) {
        list.innerHTML = `
          <div class="notification-empty">
            <svg class="w-12 h-12 text-text-tertiary opacity-50" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
            </svg>
            <p class="notification-empty-title">No notifications</p>
            <p class="notification-empty-message">You're all caught up!</p>
          </div>
        `;
        return;
      }

      list.innerHTML = notifications.map(n => renderNotificationItem(n)).join('');
      updateBadge();
    }

    function renderNotificationItem(notification) {
      const iconClass = `notification-icon-${notification.type}`;
      const relativeTime = getRelativeTime(notification.timestamp);

      return `
        <div class="notification-item" role="listitem" data-notification-id="${notification.id}" data-read="${notification.isRead}" tabindex="0">
          <div class="notification-icon ${iconClass}">
            ${getIconSvg(notification.icon)}
          </div>
          <div class="notification-content">
            <div class="notification-title">${notification.title}</div>
            <div class="notification-message">${notification.message}</div>
            <div class="notification-meta">
              <span class="notification-timestamp" title="${notification.timestamp.toISOString()}">${relativeTime}</span>
              <span class="notification-type-badge">${notification.typeName}</span>
            </div>
          </div>
          <div class="notification-actions">
            <button onclick="toggleNotificationRead(event, '${notification.id}')" class="notification-action-btn" aria-label="Mark as ${notification.isRead ? 'unread' : 'read'}" title="Mark as ${notification.isRead ? 'unread' : 'read'}">
              <svg class="w-4 h-4 notification-unread-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
              </svg>
              <svg class="w-4 h-4 notification-read-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 19v-8.93a2 2 0 01.89-1.664l7-4.666a2 2 0 012.22 0l7 4.666A2 2 0 0121 10.07V19M3 19a2 2 0 002 2h14a2 2 0 002-2M3 19l6.75-4.5M21 19l-6.75-4.5M3 10l6.75 4.5M21 10l-6.75 4.5m0 0l-1.14.76a2 2 0 01-2.22 0l-1.14-.76" />
              </svg>
            </button>
            <button onclick="dismissNotification(event, '${notification.id}')" class="notification-action-btn" aria-label="Dismiss notification" title="Dismiss">
              <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          <a href="${notification.link}" class="notification-overlay-link" aria-label="View details"></a>
        </div>
      `;
    }

    function getIconSvg(icon) {
      const icons = {
        warning: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />',
        users: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />',
        code: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />'
      };
      return `<svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">${icons[icon] || icons.warning}</svg>`;
    }

    function getRelativeTime(timestamp) {
      const diff = Date.now() - timestamp.getTime();
      const minutes = Math.floor(diff / 60000);

      if (minutes < 1) return 'Just now';
      if (minutes < 60) return `${minutes} minute${minutes !== 1 ? 's' : ''} ago`;

      const hours = Math.floor(minutes / 60);
      if (hours < 24) return `${hours} hour${hours !== 1 ? 's' : ''} ago`;

      const days = Math.floor(hours / 24);
      return `${days} day${days !== 1 ? 's' : ''} ago`;
    }

    function toggleNotificationDropdown() {
      const dropdown = document.getElementById('notificationDropdown');
      const button = document.getElementById('notificationBellButton');
      const isActive = dropdown.classList.contains('active');

      if (isActive) {
        dropdown.classList.remove('active');
        button.setAttribute('aria-expanded', 'false');
      } else {
        dropdown.classList.add('active');
        button.setAttribute('aria-expanded', 'true');
      }
    }

    function toggleNotificationRead(event, id) {
      event.stopPropagation();
      const notification = notifications.find(n => n.id === id);
      if (notification) {
        notification.isRead = !notification.isRead;
        renderNotifications();
      }
    }

    function dismissNotification(event, id) {
      event.stopPropagation();
      notifications = notifications.filter(n => n.id !== id);
      renderNotifications();
    }

    function markAllAsRead() {
      notifications.forEach(n => n.isRead = true);
      renderNotifications();
    }

    function updateBadge() {
      const badge = document.getElementById('notificationBadge');
      const unreadCount = notifications.filter(n => !n.isRead).length;

      if (unreadCount > 0) {
        badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
        badge.setAttribute('aria-label', `${unreadCount} unread notification${unreadCount !== 1 ? 's' : ''}`);
        badge.classList.remove('hidden');
      } else {
        badge.classList.add('hidden');
      }
    }

    function addSampleNotification(type) {
      const sample = sampleNotifications[type];
      const newNotification = {
        ...sample,
        id: Date.now().toString(),
        timestamp: new Date(),
        isRead: false
      };

      notifications.unshift(newNotification);
      if (notifications.length > 15) notifications.pop();

      renderNotifications();

      const badge = document.getElementById('notificationBadge');
      badge.classList.add('pulse-once');
      setTimeout(() => badge.classList.remove('pulse-once'), 600);
    }

    function showEmptyState() {
      notifications = [];
      renderNotifications();
    }

    function resetNotifications() {
      notifications = [
        { ...sampleNotifications.critical, id: '1' },
        { ...sampleNotifications.warning, id: '2' },
        { ...sampleNotifications.guild, id: '3' },
        { ...sampleNotifications.command, id: '4' },
        { ...sampleNotifications.guild, id: '5', title: 'Bot Removed from Server', message: 'TestGuild (89 members)', isRead: false }
      ];
      renderNotifications();
    }

    // Close dropdown on click outside
    document.addEventListener('click', (event) => {
      const dropdown = document.getElementById('notificationDropdown');
      const button = document.getElementById('notificationBellButton');

      if (dropdown.classList.contains('active') &&
          !dropdown.contains(event.target) &&
          !button.contains(event.target)) {
        dropdown.classList.remove('active');
        button.setAttribute('aria-expanded', 'false');
      }
    });

    // Close dropdown on Escape key
    document.addEventListener('keydown', (event) => {
      if (event.key === 'Escape') {
        const dropdown = document.getElementById('notificationDropdown');
        const button = document.getElementById('notificationBellButton');

        if (dropdown.classList.contains('active')) {
          dropdown.classList.remove('active');
          button.setAttribute('aria-expanded', 'false');
          button.focus();
        }
      }
    });

    // Initialize
    renderNotifications();
  </script>
</body>
</html>
