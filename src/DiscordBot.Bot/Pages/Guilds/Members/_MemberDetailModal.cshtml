@* Member Detail Modal - Partial View *@
@* This modal is populated dynamically via JavaScript when viewing a member *@

<!-- Modal Overlay -->
<div id="memberDetailModal"
     class="hidden fixed inset-0 z-50 overflow-y-auto"
     aria-labelledby="memberDetailTitle"
     role="dialog"
     aria-modal="true">
    <div class="flex min-h-screen items-center justify-center p-4">
        <!-- Dark Backdrop -->
        <div class="fixed inset-0 bg-black/75 transition-opacity" onclick="closeMemberModal()" aria-hidden="true"></div>

        <!-- Modal Content -->
        <div class="relative bg-bg-tertiary border border-border-primary rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden">
            <!-- Header -->
            <div class="flex items-center justify-between px-6 py-4 border-b border-border-primary">
                <h2 id="memberDetailTitle" class="text-xl font-semibold text-text-primary">Member Details</h2>
                <button type="button"
                        class="text-text-secondary hover:text-text-primary transition-colors p-1"
                        onclick="closeMemberModal()"
                        aria-label="Close modal">
                    <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <!-- Body (scrollable) -->
            <div id="memberDetailBody" class="overflow-y-auto max-h-[calc(90vh-140px)] px-6 py-6">
                <!-- Loading State -->
                <div id="memberDetailLoading" class="flex items-center justify-center py-12">
                    <svg class="w-8 h-8 animate-spin text-accent-blue" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span class="ml-3 text-sm text-text-secondary">Loading member details...</span>
                </div>

                <!-- Error State -->
                <div id="memberDetailError" class="hidden px-6 py-12 text-center">
                    <svg class="w-12 h-12 mx-auto text-error mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <h3 class="text-lg font-medium text-text-primary mb-2">Failed to load member</h3>
                    <p class="text-sm text-text-secondary mb-4">This member may have left the server or been removed.</p>
                    <button type="button" class="btn btn-secondary" onclick="closeMemberModal()">Close</button>
                </div>

                <!-- Content State (populated via JS) -->
                <div id="memberDetailContent" class="hidden">
                    <!-- Profile Section -->
                    <div class="flex items-start gap-4 mb-6 pb-6 border-b border-border-secondary">
                        <!-- Large Avatar -->
                        <img id="modalAvatar" src="" alt="" class="w-20 h-20 rounded-full flex-shrink-0" />
                        <div id="modalAvatarPlaceholder" class="hidden w-20 h-20 rounded-full bg-gradient-to-br from-accent-blue to-accent-orange flex items-center justify-center text-white font-bold text-2xl flex-shrink-0">
                            <span id="modalAvatarInitials"></span>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 id="modalDisplayName" class="text-lg font-semibold text-text-primary mb-1"></h3>
                            <p id="modalUsername" class="text-sm text-text-secondary font-mono mb-2"></p>
                            <p class="text-xs text-text-tertiary">
                                <span>User ID: </span>
                                <span id="modalUserId" class="font-mono select-all"></span>
                                <button type="button"
                                        class="ml-2 text-accent-blue hover:text-accent-blue-hover"
                                        onclick="copyUserId()"
                                        aria-label="Copy user ID">
                                    <svg class="w-4 h-4 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                    </svg>
                                </button>
                            </p>
                        </div>
                    </div>

                    <!-- Info Grid -->
                    <div class="grid grid-cols-2 gap-6 mb-6">
                        <!-- Account Created -->
                        <div>
                            <p class="text-xs text-text-tertiary uppercase tracking-wider mb-1">Account Created</p>
                            <p id="modalAccountCreated" class="text-sm text-text-primary"></p>
                            <p id="modalAccountAge" class="text-xs text-text-tertiary"></p>
                        </div>

                        <!-- Joined Server -->
                        <div>
                            <p class="text-xs text-text-tertiary uppercase tracking-wider mb-1">Joined Server</p>
                            <p id="modalJoinDate" class="text-sm text-text-primary"></p>
                            <p id="modalJoinAge" class="text-xs text-text-tertiary"></p>
                        </div>

                        <!-- Last Active -->
                        <div>
                            <p class="text-xs text-text-tertiary uppercase tracking-wider mb-1">Last Active</p>
                            <p id="modalLastActive" class="text-sm text-text-primary"></p>
                            <p id="modalLastActiveExact" class="text-xs text-text-tertiary"></p>
                        </div>

                        <!-- Nickname -->
                        <div>
                            <p class="text-xs text-text-tertiary uppercase tracking-wider mb-1">Nickname</p>
                            <p id="modalNickname" class="text-sm text-text-primary"></p>
                        </div>
                    </div>

                    <!-- Roles Section -->
                    <div class="mb-6">
                        <h4 class="text-sm font-semibold text-text-primary uppercase tracking-wider mb-3">
                            Roles <span id="modalRoleCount" class="text-text-tertiary font-normal">(0)</span>
                        </h4>
                        <div id="modalRoleList" class="flex flex-wrap gap-2">
                            <!-- Roles populated dynamically -->
                        </div>
                        <div id="modalNoRoles" class="hidden text-sm text-text-tertiary">
                            No roles assigned
                        </div>
                    </div>

                    <!-- Activity Summary (Placeholder) -->
                    <div class="mb-6">
                        <h4 class="text-sm font-semibold text-text-primary uppercase tracking-wider mb-3">Activity Summary</h4>
                        <div class="bg-bg-secondary rounded-lg p-4">
                            <div class="flex items-center gap-3 text-sm text-text-secondary">
                                <svg class="w-5 h-5 text-text-tertiary flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                <p>Activity analytics and message history will be available in a future update.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Stats Row -->
                    <div class="grid grid-cols-3 gap-4">
                        <div class="bg-bg-secondary rounded-lg p-4 text-center">
                            <p id="modalRoleCountStat" class="text-2xl font-bold text-accent-blue">0</p>
                            <p class="text-xs text-text-tertiary">Roles</p>
                        </div>
                        <div class="bg-bg-secondary rounded-lg p-4 text-center">
                            <p id="modalMemberStatus" class="text-2xl font-bold text-success">Active</p>
                            <p class="text-xs text-text-tertiary">Status</p>
                        </div>
                        <div class="bg-bg-secondary rounded-lg p-4 text-center">
                            <p class="text-2xl font-bold text-text-tertiary">-</p>
                            <p class="text-xs text-text-tertiary">Messages</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer Actions -->
            <div class="flex items-center justify-end gap-3 px-6 py-4 border-t border-border-primary bg-bg-secondary">
                <button type="button"
                        class="btn btn-secondary"
                        onclick="closeMemberModal()">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>
