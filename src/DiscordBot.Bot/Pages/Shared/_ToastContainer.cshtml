@*
    Toast Notification Container
    Include this partial in _Layout.cshtml to enable toast notifications.

    Usage from JavaScript:
        ToastManager.show('success', 'Your changes have been saved.');
        ToastManager.show('error', 'Something went wrong.', { title: 'Error', duration: 10000 });
        ToastManager.show('warning', 'Rate limit approaching.');
        ToastManager.show('info', 'New features available.');
*@

<!-- Toast Container -->
<div id="toastContainer"
     class="fixed top-20 right-4 z-[1300] flex flex-col gap-2 pointer-events-none max-h-[calc(100vh-80px)] overflow-hidden"
     role="region"
     aria-label="Notifications">
    <!-- Accessible live region for screen readers -->
    <div id="toastLiveRegion" class="sr-only" aria-live="polite" aria-atomic="true"></div>
</div>

@* Render any TempData toasts passed from server-side *@
@{
    var toastSuccess = TempData["ToastSuccess"]?.ToString();
    var toastSuccessTitle = TempData["ToastSuccessTitle"]?.ToString();
    var toastError = TempData["ToastError"]?.ToString();
    var toastErrorTitle = TempData["ToastErrorTitle"]?.ToString();
    var toastWarning = TempData["ToastWarning"]?.ToString();
    var toastWarningTitle = TempData["ToastWarningTitle"]?.ToString();
    var toastInfo = TempData["ToastInfo"]?.ToString();
    var toastInfoTitle = TempData["ToastInfoTitle"]?.ToString();
}
@if (!string.IsNullOrEmpty(toastSuccess) || !string.IsNullOrEmpty(toastError) || !string.IsNullOrEmpty(toastWarning) || !string.IsNullOrEmpty(toastInfo))
{
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            @if (!string.IsNullOrEmpty(toastSuccess))
            {
                <text>
                ToastManager.show('success', @Html.Raw(Json.Serialize(toastSuccess)), {
                    title: @Html.Raw(Json.Serialize(toastSuccessTitle))
                });
                </text>
            }
            @if (!string.IsNullOrEmpty(toastError))
            {
                <text>
                ToastManager.show('error', @Html.Raw(Json.Serialize(toastError)), {
                    title: @Html.Raw(Json.Serialize(toastErrorTitle)),
                    duration: 10000
                });
                </text>
            }
            @if (!string.IsNullOrEmpty(toastWarning))
            {
                <text>
                ToastManager.show('warning', @Html.Raw(Json.Serialize(toastWarning)), {
                    title: @Html.Raw(Json.Serialize(toastWarningTitle))
                });
                </text>
            }
            @if (!string.IsNullOrEmpty(toastInfo))
            {
                <text>
                ToastManager.show('info', @Html.Raw(Json.Serialize(toastInfo)), {
                    title: @Html.Raw(Json.Serialize(toastInfoTitle))
                });
                </text>
            }
        });
    </script>
}
